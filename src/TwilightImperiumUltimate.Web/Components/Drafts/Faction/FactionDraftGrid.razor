@using TwilightImperiumUltimate.Web.Components.Shared.Controls
@using TwilightImperiumUltimate.Web.Components.Shared.Layouts
@using TwilightImperiumUltimate.Web.Resources;
@using TwilightImperiumUltimate.Web.Components.Factions;
@using TwilightImperiumUltimate.Web.Components.Shared.Text;

<FactionIconRow EnableBanMode="true" OnFactionClickGetFaction="UpdateBanFactions" @ref="_factionIconRow" />

<FlexColumnCenter>
    <Title Text="@Strings.FactionDraft_Title"></Title>
    <HelpText Text="@Strings.FactionDraft_BanHelp" CssClass="margin-top-10" />
</FlexColumnCenter>

<div class="setting-row">
    <div class="title white handel shadow flex-row">
        <div>@Strings.DraftText_NumberOfPlayers</div>
        <ArrowButton ArrowSymbol="@((MarkupString)Strings.ButtonLeftArrow)" OnArrowClick="DecreasePlayerCount" />
        <div>@FactionDraftService.NumberOfPlayers</div>
        <ArrowButton ArrowSymbol="@((MarkupString)Strings.ButtonRightArrow)" OnArrowClick="IncreasePlayerCount" />
    </div>
    <div class="title white handel shadow flex-row">
        <div>@Strings.DraftText_NumberOfFactions</div>
        <ArrowButton ArrowSymbol="@((MarkupString)Strings.ButtonLeftArrow)" OnArrowClick="DecreaseFactionCount" />
        <div>@FactionDraftService.NumberOfDraftFactions</div>
        <ArrowButton ArrowSymbol="@((MarkupString)Strings.ButtonRightArrow)" OnArrowClick="IncreaseFactionCount" />
    </div>
</div>

<FlexRow CssClass="margin-top-50">
    <Button ButtonText="@(GetButtonStateText())"
            IsDisabled=@(IsDraftButtonDisabled())
            OnClick="DraftFactions" />

    <Button ButtonText="@Strings.DraftButton_ResetBans" 
            OnClick="ResetBans" />
</FlexRow>

@if (FactionDraftService.ToManyBans)
{
    <div class="flex-column-center margin-top-10">
        <div class="flex-container-center text-small white handel shadow">
            @Strings.DraftText_DraftNotPossible
        </div>
    </div>
}

<div class="faction-draft-players-container">
    @{ int index = 0; }

    @foreach (var factionDraftPlayer in FactionDraftService.Players)
    {
        index++;
        <FactionDraftPlayerRow Player="@factionDraftPlayer" Index="@index" DraftStage="_draftStage" />
    }
</div>
