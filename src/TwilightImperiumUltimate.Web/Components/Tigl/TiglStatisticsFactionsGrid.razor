@using TwilightImperiumUltimate.Contracts.DTOs.Tigl
@using TwilightImperiumUltimate.Web.Components.Ranking
@using TwilightImperiumUltimate.Web.Components.Shared
@using TwilightImperiumUltimate.Web.Components.Shared.Layouts
@using TwilightImperiumUltimate.Web.Helpers.Enums
@using TwilightImperiumUltimate.Web.Helpers.Numbers

<VerticalSpace Height="20" />

<GridLayout Columns="6" CssClass="handel white shadow background" Style="grid-template-columns: 5% 35% 12% 12% 18% 18%">

    <VerticalSpace Height="20" CssClass="span-6" />
    <Label />
    <Label Text="Faction" TextColor="TextColor.Yellow" />
    <Label Text="Games" TextColor="TextColor.Yellow" CenterText="true" />
    <Label Text="Wins" TextColor="TextColor.Yellow" CenterText="true" />
    <Label Text="Win Rate" TextColor="TextColor.Yellow" CenterText="true" />
    <Label Text="Avg Score" TextColor="TextColor.Yellow" CenterText="true" />
    <VerticalSpace Height="15" CssClass="span-6" />

</GridLayout>

<VerticalSpace Height="20" />

@if (_loading)
{
    <VerticalSpace Height="50" />
    <Label Text="...Loading faction stats..." CenterText="true" />
    <VerticalSpace Height="50" />
}
else if (_rows.Count == 0)
{
    <VerticalSpace Height="50" />
    <Label Text="No data" CenterText="true" />
    <VerticalSpace Height="50" />
}
else
{
    <GridLayout Columns="6" CssClass="handel white shadow background" Style="grid-template-columns: 5% 35% 12% 12% 18% 18%">

        <VerticalSpace Height="20" CssClass="span-6" />

        @foreach (var r in _rows.OrderByDescending(x => x.WinRate).ThenByDescending(x => x.AverageScore).ThenBy(x => x.GamesPlayed))
        {
            <Label />
            <FlexRowContainer JustifyContent="Enums.JustifyContent.FlexStart">
                <TiglFactionImg Faction="@r.Faction" Width="30" />
                <Label Text="@r.Faction.GetDisplayName()" />
            </FlexRowContainer>
            <Label Text="@r.GamesPlayed.ToString()" CenterText="true" TextColor="TextColor.Yellow" />
            <Label Text="@r.Wins.ToString()" CenterText="true" TextColor="TextColor.Green" />
            <Label Text="@($"{r.WinRate.ToString("F2")}%")" CenterText="true" TextColor="GetWinrateColor(r.WinRate)" />
            <Label Text="@r.AverageScore.ToString("F2")" CenterText="true" TextColor="@r.AverageScore.GetAverageVpColor()" />
        }

        <VerticalSpace Height="20" CssClass="span-6" />

    </GridLayout>
}
